<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="ploneboard">

<head>
    <metal:css fill-slot="css_slot">
    <style type="text/css" media="all"
           tal:content="string: @import url($portal_url/ploneboard.css);"></style>
    </metal:css>
</head>
      
<body>

    <div metal:fill-slot="main"
         tal:define="forums here/getForums;
                     keyedforums python:here.getKeyedForums(forums);
                     categories here/getCategories|nothing;">
        <h1 class="documentFirstHeading">
        <img src="" tal:replace="structure here/ploneboard_icon.gif" />
        <span tal:replace="here/Title">Board title</span>
        </h1>
        
        <p class="documentDescription"
            tal:content="here/description">
            Board Description
        </p>

        <div class="discreet"
             tal:condition="not: forums" i18n:translate="not_forums">
        No forums exist in this board yet, use the add menu to add forums.
        </div>
        

        <tal:categories repeat="category categories">
            <tal:category define="forums keyedforums/?category|nothing"
                          condition="forums">
                <h2 tal:condition="category"
                    tal:content="category">Forum category 1</h2>
                <!-- There should be categories available on the Board objects, 
                     and these should be iterated over in the board_view. If there are
                     no categories, it should not break (we don't depend on the board 
                     container) -->

                <table metal:define-macro="forumdisplay"
                       class="listing"
                       style="width: 100%;">

                    <thead>
                        <tr>
                            <th i18n:translate="forum_name">Forum name</th>
                            <th i18n:translate="number_of_conversations">Conversations</th>
                            <th i18n:translate="most_recent_post">Most recent post</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tal:showforums tal:repeat="forum forums">
    
                            <tr tal:define="oddrow repeat/forum/odd;"
                                tal:attributes="class python:test(oddrow, 'even', 'odd')">

                                <td>      
                                    <a href=""
                                       class="listingForum"
                                       tal:attributes="href forum/absolute_url">
                                            <span tal:replace="forum/Title">This is a title</span>
    
                                            <span class="discreet" tal:content="forum/Description">
                                            This is the Forum Description
                                            </span>
                                    </a>
                                </td>

                                <td tal:content="forum/getNumberOfConversations">
                                    34
                                </td>

                                <!-- 
                                    This should show "Thursday 13:56" if in this week, "Aug 13. 2003" 
                                    if older than this week. (limi)
                                -->
                                <td tal:condition="not: forum/getLastCommentAuthor">
                                    <span i18n:translate="no_conversations_started" class="discreet">No conversations started</span>
                                </td>

                                <td tal:condition="forum/getLastCommentAuthor">
                            
                                    <div i18n:translate="label_by_author">
                                        by <tal:author i18n:name="author"
                                        tal:content="forum/getLastCommentAuthor" />
                                   </div>
                                                                                                                              

                                    <span class="discreet"
                                          tal:content="python:here.toPloneboardTime(forum.getLastCommentDate())">
                                        Thursday 13:21
                                    </span>
                                </td>
                            </tr>

                        </tal:showforums>

                    </tbody>
                </table>
            </tal:category>
        </tal:categories>

        <tal:category define="forums python:keyedforums.get(None, None)"
                      condition="forums">
            <h2 i18n:translate="title_general_forums">General forums</h2>

            <table metal:use-macro="here/board_view/macros/forumdisplay" />
        </tal:category>


    <metal:footer use-macro="here/board_footer/macros/footer">Board footer</metal:footer>

    </div>
                     
</body>
</html>
